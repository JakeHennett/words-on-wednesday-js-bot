name: Bluesky Autoposter

on:
  workflow_dispatch: # manual trigger
  schedule:
    # Each job has its own cron schedule
    - cron: "30 8 * * 1"   # Monday 8:30am
    - cron: "30 8 * * 2"   # Tuesday 8:30am
    - cron: "30 8 * * 3"   # Wednesday 8:30am
    - cron: "30 15 * * 4"  # Thursday 3:30pm
    - cron: "30 9 * * 5"   # Friday 9:30am
    - cron: "0 11 * * 6"   # Saturday 11am
    - cron: "*/5 * * * *"  # ðŸ”¥ Test job: every 5 minutes


jobs:
  test:
    if: github.event.schedule == '*/5 * * * *'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "20"
      - run: npm install
      - name: Run Test job
        env:
          BLUESKY_USERNAME: ${{ secrets.BLUESKY_USERNAME }}
          BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
        run: node -e "require('./index').randomBlogspotPost()"

  monday:
    if: github.event.schedule == '30 8 * * 1'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "20"
      - run: npm install
      - name: Run Monday job
        env:
          BLUESKY_USERNAME: ${{ secrets.BLUESKY_USERNAME }}
          BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
        run: node -e "require('./index').monday()"

  tuesday:
    if: github.event.schedule == '30 8 * * 2'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "20"
      - run: npm install
      - name: Run Tuesday job
        env:
          BLUESKY_USERNAME: ${{ secrets.BLUESKY_USERNAME }}
          BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
        run: node -e "require('./index').tuesday()"

  wednesday:
    if: github.event.schedule == '30 8 * * 3'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "20"
      - run: npm install
      - name: Run Wednesday job
        env:
          BLUESKY_USERNAME: ${{ secrets.BLUESKY_USERNAME }}
          BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
        run: node -e "require('./index').wednesday()"

  thursday:
    if: github.event.schedule == '30 15 * * 4'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "20"
      - run: npm install
      - name: Run Thursday job
        env:
          BLUESKY_USERNAME: ${{ secrets.BLUESKY_USERNAME }}
          BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
        run: node -e "require('./index').thursday()"

  friday:
    if: github.event.schedule == '30 9 * * 5'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "20"
      - run: npm install
      - name: Run Friday job
        env:
          BLUESKY_USERNAME: ${{ secrets.BLUESKY_USERNAME }}
          BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
        run: node -e "require('./index').friday()"

  saturday:
    if: github.event.schedule == '0 11 * * 6'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: "20"
      - run: npm install
      - name: Run Saturday job
        env:
          BLUESKY_USERNAME: ${{ secrets.BLUESKY_USERNAME }}
          BLUESKY_PASSWORD: ${{ secrets.BLUESKY_PASSWORD }}
        run: node -e "require('./index').saturday()"